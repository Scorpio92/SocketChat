# Введение
Проект состоит из компонентов представленных ниже.

**Серверная часть**:
- [Сервер авторизации (HTTP сервер + WebSocket сервер) + БД PostgreSQL](https://github.com/Scorpio92/SocketChat/WebAuthServer)
- [WebSocket сервер + БД PostgreSQL](https://github.com/Scorpio92/SocketChat/WebSocketServer)

Все сервера физически расположены на одной виртуальной машине/контейнере.

![](https://github.com/Scorpio92/SocketChat/blob/master/Documentation/draw_io/General.jpg)

**Клиентская часть**:
- [Android приложение](https://github.com/Scorpio92/SocketChat/AndroidClient)

Информация по конфигурации и развёртыванию компонентов расположена [здесь](https://github.com/Scorpio92/SocketChat/Documentation).

# Сервер авторизации

За основу взята библиотека: [Java-WebSocket](https://github.com/TooTallNate/Java-WebSocket/tree/master/src/main/example)

API сервера авторизации делится на две части: общедоступное API и сервисное API.

### Общедоступное API

Регистрируясь, клиент передаёт никнейм, логин, пароль. Далее, после успешной регистрации, клиент в рамках авторизации меняет свой логин и пароль на бессрочный токен доступа. Если клиент хочет сделать выход из аккаунта или предотвратить компрометацию токена, он отсылает запрос на деавторизацию.

Процесс авторизации представляет из себя обмен данными между клиентом и сервером, посредством отправки клиентом REST запросов (POST) и получением ответа от сервера в едином установленном формате.

Все запросы отправляются на адрес: 
**_http://ip:8031_**

На данный момент обмен между клиентом и сервером осуществляется по незащищенному каналу. В дальнейшем, планируется шифровать Payload часть сообщения.

### Сервисное API

Закрытое для клиентов платформы API. Используется серверами (API сервер, Websocket сервера). Основное предназначение: проверка валидности токена авторизации.

Все запросы отправляются на адрес: 
**_ws://ip:8032_**

Т.о. для сервисного API поднят отдельный служебный канал с использованием протокола websocket, для обеспечения непрерывного и максимально быстрого взаимодействия.

![](https://github.com/Scorpio92/SocketChat/blob/master/Documentation/draw_io/AuthProcessNoEncryption.jpg)

# WebSocket сервер

Между клиентом и сервером связь осуществляется по открытому (незащищенному) каналу. При подключении клиента к серверу, клиент должен предоставить токен, полученный на этапе авторизации.

Сервер служит для маршрутизации сообщений между клиентами.

Все запросы отправляются на адрес: 
**_ws://ip:8081_**

![](https://github.com/Scorpio92/SocketChat/blob/master/Documentation/draw_io/ClientAndWebSocket.jpg)
